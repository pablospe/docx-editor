{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"docx-editor","text":"<p>Pure Python library for Word document track changes and comments, without requiring Microsoft Word.</p> <p>Note: The PyPI package is named <code>docx-editor</code> because <code>docx-edit</code> was too similar to an existing package.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Track Changes: Replace, delete, and insert text with revision tracking</li> <li>Comments: Add, reply, resolve, and delete comments</li> <li>Revision Management: List, accept, and reject tracked changes</li> <li>Cross-Platform: Works on Linux, macOS, and Windows</li> <li>No Dependencies: Only requires <code>defusedxml</code> for secure XML parsing</li> </ul>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install docx-editor\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>from docx_editor import Document\n\n# Open and edit\ndoc = Document.open(\"contract.docx\")\ndoc.replace(\"30 days\", \"60 days\")           # Tracked replacement\ndoc.insert_after(\"Section 5\", \"New clause\") # Tracked insertion\ndoc.delete(\"obsolete text\")                 # Tracked deletion\n\n# Comments\ndoc.add_comment(\"Section 5\", \"Please review\")\ndoc.reply_to_comment(comment_id=0, \"Approved\")\n\n# Revision management\nrevisions = doc.list_revisions()\ndoc.accept_revision(revision_id=1)\ndoc.reject_all(author=\"OtherUser\")\n\n# Save and close\ndoc.save()\ndoc.close()\n</code></pre>"},{"location":"#context-manager","title":"Context Manager","text":"<pre><code>from docx_editor import Document\n\nwith Document.open(\"contract.docx\") as doc:\n    doc.replace(\"old term\", \"new term\")\n    doc.save()\n# Automatically closes and cleans up workspace\n</code></pre>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#document","title":"Document","text":"<p>The main entry point for docx-editor. Provides methods for opening documents, making tracked changes, managing comments, and handling revisions.</p> <pre><code>from docx_editor import Document\n</code></pre>"},{"location":"api/#opening-documents","title":"Opening Documents","text":""},{"location":"api/#documentopenpath-authornone-force_recreatefalse","title":"<code>Document.open(path, author=None, force_recreate=False)</code>","text":"<p>Open a Word document for editing.</p> <p>Parameters:</p> <ul> <li><code>path</code> (str | Path): Path to the .docx file</li> <li><code>author</code> (str, optional): Author name for tracked changes. Defaults to system username.</li> <li><code>force_recreate</code> (bool): If True, delete existing workspace and create fresh. Defaults to False.</li> </ul> <p>Returns: Document instance ready for editing</p> <p>Example:</p> <pre><code>doc = Document.open(\"contract.docx\")\ndoc = Document.open(\"contract.docx\", author=\"Legal Team\")\n</code></pre>"},{"location":"api/#properties","title":"Properties","text":""},{"location":"api/#author","title":"<code>author</code>","text":"<p>Get the author name for tracked changes.</p> <pre><code>print(doc.author)  # \"Legal Team\"\n</code></pre>"},{"location":"api/#source_path","title":"<code>source_path</code>","text":"<p>Get the path to the source document.</p> <pre><code>print(doc.source_path)  # Path(\"/path/to/contract.docx\")\n</code></pre>"},{"location":"api/#track-changes-methods","title":"Track Changes Methods","text":""},{"location":"api/#replacefind-replace_with","title":"<code>replace(find, replace_with)</code>","text":"<p>Replace text with tracked changes.</p> <p>Parameters:</p> <ul> <li><code>find</code> (str): Text to find and replace</li> <li><code>replace_with</code> (str): Replacement text</li> </ul> <p>Returns: The change ID of the insertion (int)</p> <p>Example:</p> <pre><code>doc.replace(\"30 days\", \"60 days\")\n</code></pre>"},{"location":"api/#deletetext","title":"<code>delete(text)</code>","text":"<p>Mark text as deleted with tracked changes.</p> <p>Parameters:</p> <ul> <li><code>text</code> (str): Text to mark as deleted</li> </ul> <p>Returns: The change ID of the deletion (int)</p> <p>Example:</p> <pre><code>doc.delete(\"obsolete clause\")\n</code></pre>"},{"location":"api/#insert_afteranchor-text","title":"<code>insert_after(anchor, text)</code>","text":"<p>Insert text after anchor with tracked changes.</p> <p>Parameters:</p> <ul> <li><code>anchor</code> (str): Text to find as insertion point</li> <li><code>text</code> (str): Text to insert after the anchor</li> </ul> <p>Returns: The change ID of the insertion (int)</p> <p>Example:</p> <pre><code>doc.insert_after(\"Section 5\", \" (as amended)\")\n</code></pre>"},{"location":"api/#insert_beforeanchor-text","title":"<code>insert_before(anchor, text)</code>","text":"<p>Insert text before anchor with tracked changes.</p> <p>Parameters:</p> <ul> <li><code>anchor</code> (str): Text to find as insertion point</li> <li><code>text</code> (str): Text to insert before the anchor</li> </ul> <p>Returns: The change ID of the insertion (int)</p> <p>Example:</p> <pre><code>doc.insert_before(\"Section 6\", \"New clause: \")\n</code></pre>"},{"location":"api/#comment-methods","title":"Comment Methods","text":""},{"location":"api/#add_commentanchor_text-comment","title":"<code>add_comment(anchor_text, comment)</code>","text":"<p>Add a comment anchored to specific text.</p> <p>Parameters:</p> <ul> <li><code>anchor_text</code> (str): Text to attach the comment to</li> <li><code>comment</code> (str): The comment content</li> </ul> <p>Returns: The comment ID (int)</p> <p>Example:</p> <pre><code>doc.add_comment(\"Section 5\", \"Please review this section\")\n</code></pre>"},{"location":"api/#reply_to_commentcomment_id-reply","title":"<code>reply_to_comment(comment_id, reply)</code>","text":"<p>Add a reply to an existing comment.</p> <p>Parameters:</p> <ul> <li><code>comment_id</code> (int): ID of the comment to reply to</li> <li><code>reply</code> (str): The reply content</li> </ul> <p>Returns: The new comment ID for the reply (int)</p> <p>Example:</p> <pre><code>doc.reply_to_comment(0, \"I agree with this change\")\n</code></pre>"},{"location":"api/#list_commentsauthornone","title":"<code>list_comments(author=None)</code>","text":"<p>List all comments in the document.</p> <p>Parameters:</p> <ul> <li><code>author</code> (str, optional): If provided, filter by author name</li> </ul> <p>Returns: List of Comment objects (with replies nested)</p> <p>Example:</p> <pre><code>comments = doc.list_comments()\nfor c in comments:\n    print(f\"{c.author}: {c.text}\")\n</code></pre>"},{"location":"api/#resolve_commentcomment_id","title":"<code>resolve_comment(comment_id)</code>","text":"<p>Mark a comment as resolved.</p> <p>Parameters:</p> <ul> <li><code>comment_id</code> (int): ID of the comment to resolve</li> </ul> <p>Returns: True if resolved, False if not found (bool)</p> <p>Example:</p> <pre><code>doc.resolve_comment(0)\n</code></pre>"},{"location":"api/#delete_commentcomment_id","title":"<code>delete_comment(comment_id)</code>","text":"<p>Delete a comment from the document.</p> <p>Parameters:</p> <ul> <li><code>comment_id</code> (int): ID of the comment to delete</li> </ul> <p>Returns: True if deleted, False if not found (bool)</p> <p>Example:</p> <pre><code>doc.delete_comment(0)\n</code></pre>"},{"location":"api/#revision-management-methods","title":"Revision Management Methods","text":""},{"location":"api/#list_revisionsauthornone","title":"<code>list_revisions(author=None)</code>","text":"<p>List all tracked changes in the document.</p> <p>Parameters:</p> <ul> <li><code>author</code> (str, optional): If provided, filter by author name</li> </ul> <p>Returns: List of Revision objects</p> <p>Example:</p> <pre><code>revisions = doc.list_revisions()\nfor r in revisions:\n    print(f\"{r.type}: {r.text} by {r.author}\")\n</code></pre>"},{"location":"api/#accept_revisionrevision_id","title":"<code>accept_revision(revision_id)</code>","text":"<p>Accept a revision by ID.</p> <ul> <li>For insertions: keeps the inserted content</li> <li>For deletions: permanently removes the deleted content</li> </ul> <p>Parameters:</p> <ul> <li><code>revision_id</code> (int): ID of the revision to accept</li> </ul> <p>Returns: True if accepted, False if not found (bool)</p> <p>Example:</p> <pre><code>doc.accept_revision(1)\n</code></pre>"},{"location":"api/#reject_revisionrevision_id","title":"<code>reject_revision(revision_id)</code>","text":"<p>Reject a revision by ID.</p> <ul> <li>For insertions: removes the inserted content</li> <li>For deletions: restores the deleted content</li> </ul> <p>Parameters:</p> <ul> <li><code>revision_id</code> (int): ID of the revision to reject</li> </ul> <p>Returns: True if rejected, False if not found (bool)</p> <p>Example:</p> <pre><code>doc.reject_revision(1)\n</code></pre>"},{"location":"api/#accept_allauthornone","title":"<code>accept_all(author=None)</code>","text":"<p>Accept all revisions.</p> <p>Parameters:</p> <ul> <li><code>author</code> (str, optional): If provided, only accept revisions by this author</li> </ul> <p>Returns: Number of revisions accepted (int)</p> <p>Example:</p> <pre><code>count = doc.accept_all()\nprint(f\"Accepted {count} revisions\")\n</code></pre>"},{"location":"api/#reject_allauthornone","title":"<code>reject_all(author=None)</code>","text":"<p>Reject all revisions.</p> <p>Parameters:</p> <ul> <li><code>author</code> (str, optional): If provided, only reject revisions by this author</li> </ul> <p>Returns: Number of revisions rejected (int)</p> <p>Example:</p> <pre><code>count = doc.reject_all(author=\"OtherUser\")\n</code></pre>"},{"location":"api/#save-and-close-methods","title":"Save and Close Methods","text":""},{"location":"api/#savepathnone-validatefalse","title":"<code>save(path=None, validate=False)</code>","text":"<p>Save the document.</p> <p>Parameters:</p> <ul> <li><code>path</code> (str | Path, optional): Output path. Defaults to original source path.</li> <li><code>validate</code> (bool): If True, validate with LibreOffice before saving. Defaults to False.</li> </ul> <p>Returns: Path to the saved document (Path)</p> <p>Example:</p> <pre><code>doc.save()  # Save to original path\ndoc.save(\"contract_v2.docx\")  # Save to new path\n</code></pre>"},{"location":"api/#closecleanuptrue","title":"<code>close(cleanup=True)</code>","text":"<p>Close the document and clean up workspace.</p> <p>Parameters:</p> <ul> <li><code>cleanup</code> (bool): If True, delete the workspace folder. Defaults to True.</li> </ul> <p>Example:</p> <pre><code>doc.close()  # Clean up workspace\ndoc.close(cleanup=False)  # Keep workspace for inspection\n</code></pre>"},{"location":"api/#comment","title":"Comment","text":"<p>Represents a document comment.</p> <pre><code>from docx_editor import Comment\n</code></pre>"},{"location":"api/#attributes","title":"Attributes","text":"Attribute Type Description <code>id</code> int The comment ID <code>text</code> str The comment content <code>author</code> str The comment author <code>date</code> datetime or None When the comment was created <code>resolved</code> bool Whether the comment is resolved <code>replies</code> list[Comment] Nested replies to this comment"},{"location":"api/#example","title":"Example","text":"<pre><code>comments = doc.list_comments()\nfor comment in comments:\n    print(f\"ID: {comment.id}\")\n    print(f\"Text: {comment.text}\")\n    print(f\"Author: {comment.author}\")\n    print(f\"Date: {comment.date}\")\n    print(f\"Resolved: {comment.resolved}\")\n    print(f\"Replies: {len(comment.replies)}\")\n</code></pre>"},{"location":"api/#revision","title":"Revision","text":"<p>Represents a tracked change (insertion or deletion).</p> <pre><code>from docx_editor import Revision\n</code></pre>"},{"location":"api/#attributes_1","title":"Attributes","text":"Attribute Type Description <code>id</code> int The revision ID <code>type</code> str Either \"insertion\" or \"deletion\" <code>author</code> str The revision author <code>date</code> datetime or None When the revision was made <code>text</code> str The inserted or deleted text"},{"location":"api/#example_1","title":"Example","text":"<pre><code>revisions = doc.list_revisions()\nfor rev in revisions:\n    symbol = \"+\" if rev.type == \"insertion\" else \"-\"\n    print(f\"{symbol} {rev.text} (by {rev.author})\")\n</code></pre>"},{"location":"api/#exceptions","title":"Exceptions","text":""},{"location":"api/#textnotfounderror","title":"<code>TextNotFoundError</code>","text":"<p>Raised when the specified text is not found in the document.</p> <pre><code>from docx_editor.exceptions import TextNotFoundError\n\ntry:\n    doc.replace(\"nonexistent text\", \"new text\")\nexcept TextNotFoundError as e:\n    print(f\"Text not found: {e}\")\n</code></pre>"},{"location":"api/#commenterror","title":"<code>CommentError</code>","text":"<p>Raised when a comment operation fails.</p> <pre><code>from docx_editor.exceptions import CommentError\n\ntry:\n    doc.reply_to_comment(999, \"reply\")\nexcept CommentError as e:\n    print(f\"Comment error: {e}\")\n</code></pre>"},{"location":"api/#revisionerror","title":"<code>RevisionError</code>","text":"<p>Raised when a revision operation fails.</p> <pre><code>from docx_editor.exceptions import RevisionError\n</code></pre>"},{"location":"api/#workspaceexistserror","title":"<code>WorkspaceExistsError</code>","text":"<p>Raised when attempting to create a workspace that already exists.</p> <pre><code>from docx_editor.exceptions import WorkspaceExistsError\n</code></pre>"},{"location":"api/#workspacesyncerror","title":"<code>WorkspaceSyncError</code>","text":"<p>Raised when the workspace is out of sync with the source document.</p> <pre><code>from docx_editor.exceptions import WorkspaceSyncError\n</code></pre>"},{"location":"quickstart/","title":"Quick Start","text":"<p>This guide covers the essential usage patterns for docx-editor.</p>"},{"location":"quickstart/#opening-documents","title":"Opening Documents","text":""},{"location":"quickstart/#basic-open","title":"Basic Open","text":"<pre><code>from docx_editor import Document\n\ndoc = Document.open(\"contract.docx\")\n# ... make changes ...\ndoc.save()\ndoc.close()\n</code></pre>"},{"location":"quickstart/#with-custom-author","title":"With Custom Author","text":"<p>Track changes are attributed to the author name:</p> <pre><code>doc = Document.open(\"contract.docx\", author=\"Legal Team\")\n</code></pre>"},{"location":"quickstart/#force-recreate-workspace","title":"Force Recreate Workspace","text":"<p>If you need a fresh workspace (discarding any pending changes):</p> <pre><code>doc = Document.open(\"contract.docx\", force_recreate=True)\n</code></pre>"},{"location":"quickstart/#using-context-manager","title":"Using Context Manager","text":"<p>The recommended approach for automatic cleanup:</p> <pre><code>from docx_editor import Document\n\nwith Document.open(\"contract.docx\") as doc:\n    doc.replace(\"old term\", \"new term\")\n    doc.save()\n# Workspace is automatically cleaned up\n</code></pre>"},{"location":"quickstart/#track-changes","title":"Track Changes","text":""},{"location":"quickstart/#replace-text","title":"Replace Text","text":"<p>Replace text with a tracked deletion and insertion:</p> <pre><code>doc.replace(\"30 days\", \"60 days\")\n</code></pre> <p>This creates:</p> <ul> <li>A tracked deletion of \"30 days\"</li> <li>A tracked insertion of \"60 days\"</li> </ul>"},{"location":"quickstart/#delete-text","title":"Delete Text","text":"<p>Mark text as deleted (strikethrough in Word):</p> <pre><code>doc.delete(\"obsolete clause\")\n</code></pre>"},{"location":"quickstart/#insert-text","title":"Insert Text","text":"<p>Insert new text after or before an anchor:</p> <pre><code># Insert after a phrase\ndoc.insert_after(\"Section 5\", \" (as amended)\")\n\n# Insert before a phrase\ndoc.insert_before(\"Section 6\", \"New clause: \")\n</code></pre>"},{"location":"quickstart/#comments","title":"Comments","text":""},{"location":"quickstart/#add-a-comment","title":"Add a Comment","text":"<p>Attach a comment to specific text in the document:</p> <pre><code>comment_id = doc.add_comment(\"Section 5\", \"Please review this section\")\nprint(f\"Created comment with ID: {comment_id}\")\n</code></pre>"},{"location":"quickstart/#reply-to-a-comment","title":"Reply to a Comment","text":"<p>Add a reply to an existing comment thread:</p> <pre><code>reply_id = doc.reply_to_comment(comment_id=0, reply=\"I agree with this change\")\n</code></pre>"},{"location":"quickstart/#list-comments","title":"List Comments","text":"<p>Get all comments in the document:</p> <pre><code>comments = doc.list_comments()\nfor comment in comments:\n    print(f\"Comment {comment.id}: {comment.text}\")\n    print(f\"  Author: {comment.author}\")\n    print(f\"  Resolved: {comment.resolved}\")\n\n    # Check for replies\n    for reply in comment.replies:\n        print(f\"  Reply: {reply.text}\")\n</code></pre> <p>Filter by author:</p> <pre><code>my_comments = doc.list_comments(author=\"Legal Team\")\n</code></pre>"},{"location":"quickstart/#resolve-a-comment","title":"Resolve a Comment","text":"<p>Mark a comment as resolved:</p> <pre><code>doc.resolve_comment(comment_id=0)\n</code></pre>"},{"location":"quickstart/#delete-a-comment","title":"Delete a Comment","text":"<p>Remove a comment from the document:</p> <pre><code>doc.delete_comment(comment_id=0)\n</code></pre>"},{"location":"quickstart/#revision-management","title":"Revision Management","text":""},{"location":"quickstart/#list-revisions","title":"List Revisions","text":"<p>Get all tracked changes:</p> <pre><code>revisions = doc.list_revisions()\nfor rev in revisions:\n    print(f\"{rev.type}: '{rev.text}' by {rev.author}\")\n</code></pre> <p>Filter by author:</p> <pre><code>my_revisions = doc.list_revisions(author=\"Legal Team\")\n</code></pre>"},{"location":"quickstart/#accept-a-revision","title":"Accept a Revision","text":"<p>Accept a specific revision by ID:</p> <pre><code># For insertions: keeps the inserted content\n# For deletions: permanently removes the deleted content\ndoc.accept_revision(revision_id=1)\n</code></pre>"},{"location":"quickstart/#reject-a-revision","title":"Reject a Revision","text":"<p>Reject a specific revision by ID:</p> <pre><code># For insertions: removes the inserted content\n# For deletions: restores the deleted content\ndoc.reject_revision(revision_id=1)\n</code></pre>"},{"location":"quickstart/#acceptreject-all","title":"Accept/Reject All","text":"<p>Accept or reject all revisions at once:</p> <pre><code># Accept all revisions\ncount = doc.accept_all()\nprint(f\"Accepted {count} revisions\")\n\n# Reject all revisions by a specific author\ncount = doc.reject_all(author=\"OtherUser\")\nprint(f\"Rejected {count} revisions\")\n</code></pre>"},{"location":"quickstart/#saving-and-closing","title":"Saving and Closing","text":""},{"location":"quickstart/#save-to-original-path","title":"Save to Original Path","text":"<pre><code>doc.save()\n</code></pre>"},{"location":"quickstart/#save-to-new-path","title":"Save to New Path","text":"<pre><code>doc.save(\"contract_v2.docx\")\n</code></pre>"},{"location":"quickstart/#close-without-cleanup","title":"Close Without Cleanup","text":"<p>Keep the workspace for inspection:</p> <pre><code>doc.close(cleanup=False)\n</code></pre>"},{"location":"quickstart/#close-with-cleanup-default","title":"Close With Cleanup (Default)","text":"<p>Delete the workspace folder:</p> <pre><code>doc.close()  # cleanup=True is the default\n</code></pre>"},{"location":"quickstart/#complete-example","title":"Complete Example","text":"<pre><code>from docx_editor import Document\n\n# Open document with custom author\nwith Document.open(\"contract.docx\", author=\"Legal Review\") as doc:\n    # Make tracked changes\n    doc.replace(\"30 days\", \"60 days\")\n    doc.insert_after(\"payment terms\", \" (net 60)\")\n    doc.delete(\"penalty clause\")\n\n    # Add review comments\n    doc.add_comment(\"Section 5\", \"Needs legal review\")\n\n    # Review existing changes\n    for rev in doc.list_revisions():\n        print(f\"{rev.type}: {rev.text}\")\n\n    # Accept changes from a trusted author\n    doc.accept_all(author=\"Senior Counsel\")\n\n    # Save changes\n    doc.save()\n</code></pre>"}]}